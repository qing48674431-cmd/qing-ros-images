# RouterOS CHR v7.21.3 版本说明

本文档说明本仓库提供的 **RouterOS v7.21.3** CHR 镜像及一键安装脚本的使用方法。

## 版本信息

| 项目     | 说明                    |
| -------- | ----------------------- |
| RouterOS | v7.21.3                 |
| 脚本文件 | `v7.21.3install.sh`     |
| Release 标签 | `v7.21.3`          |

## 镜像文件

安装脚本会根据当前环境自动选择镜像：

| 启动方式   | 镜像文件名                      | 说明           |
| ---------- | ------------------------------- | -------------- |
| UEFI       | `chr-7.21.3.img`                | 标准 UEFI 镜像 |
| Legacy BIOS| `chr-7.21.3-legacy-bios.img`    | 传统 BIOS 专用 |

下载地址（由脚本自动使用）：

- UEFI: `https://github.com/qing48674431-cmd/qing-ros-images/releases/download/v7.21.3/chr-7.21.3.img`
- Legacy BIOS: `https://github.com/qing48674431-cmd/qing-ros-images/releases/download/v7.21.3/chr-7.21.3-legacy-bios.img`

## 安装步骤

1. 在目标机器上使用 **root** 或 **sudo** 权限，并确保可访问 GitHub。
2. 任选一种方式执行安装：

   **方式一：直接执行（不改密码）**

   ```bash
   wget -qO- https://raw.githubusercontent.com/qing48674431-cmd/qing-ros-images/main/v7.21.3install.sh | bash
   ```

   **方式二：先下载，改密码后再执行（推荐）**

   ```bash
   wget https://raw.githubusercontent.com/qing48674431-cmd/qing-ros-images/main/v7.21.3install.sh
   chmod +x v7.21.3install.sh
   # 编辑脚本，修改 ROS_PASSWORD 等
   ./v7.21.3install.sh
   ```

3. 脚本会：下载镜像 → 注入当前 IP/网关与管理员密码 → 写入第一块物理硬盘 → 提示重启。
4. 重启后使用脚本中设置的 `ROS_PASSWORD` 通过 **SSH（22）** 或 **Winbox** 登录。

## 脚本可配置项

在 `v7.21.3install.sh` 顶部可修改：

| 变量           | 默认值       | 说明                     |
| -------------- | ------------ | ------------------------ |
| `ROS_PASSWORD` | `Admin112233`| RouterOS admin 用户密码  |

网络（IP、网关）由脚本从当前系统自动读取并注入，无需在脚本里写死。

## 注意事项

- **数据覆盖**：镜像会写入当前识别到的**第一块物理硬盘**，该盘所有数据会被清空，请确认机器与磁盘无误。
- **网络**：需能访问 GitHub；若无法访问，请自行下载镜像并修改脚本中的 `IMG_URL` 或使用内网/对象存储地址。
- **密码**：安装前务必修改脚本中的 `ROS_PASSWORD`，不要在生产环境使用默认密码。
- **内核**：脚本使用 `losetup -P` 挂载镜像，需内核支持多分区 loop（较新内核一般均支持）。

## 版本差异参考（7.21.3 更新摘要）

本仓库镜像基于 MikroTik RouterOS CHR 构建。**v7.21.3** 为较新版本（2026-02-12），相对 7.20.x 包含多项修复与改进。以下为 [elseif/MikroTikPatch Releases](https://github.com/elseif/MikroTikPatch/releases) 中 **RouterOS 7.21.3** 的官方更新摘要（What's new in 7.21.3）：

| 模块 | 更新说明 |
|------|----------|
| **bridge** | 修复 dhcp-snooping 在 QCA8337、Atheros8327 等交换芯片上错误禁用硬件 offload 的问题（v7.20 引入） |
| **certificate** | 修复使用 SCEP 初次创建证书的问题（v7.21 引入） |
| **console** | 改进通过 CLI 处理文件时的服务稳定性 |
| **dhcpv4-server** | setup 命令中 lease-time 值后追加 "s" |
| **gps** | 修复 CubeG-5ac60ay 端口配置 |
| **hotspot** | `totp-secret` 重命名为 `otp-secret` |
| **ipv6** | 无前缀的 RA 不再使路由器失效；修复 on-link/autonomous 标志检测；仅在路由器生存期过期时使路由器失效（v7.21 引入） |
| **lte** | 修复 ATL 5G R16 的 eSIM 配置切换；改进 Quectel  modem 固件更新时的通知处理 |
| **poe-out** | hEX PoE、OmniTIK 5 PoE ac、PowerBox Pro 固件更新（会短暂中断 PoE）；修复上述设备的误报过载 |
| **sfp** | 修复 hEX PoE 的 `sfp-ignore-rx-loss` 参数 |

完整 changelog 与更多版本请见：**[elseif/MikroTikPatch Releases](https://github.com/elseif/MikroTikPatch/releases)**。

### 与 v7.20.6 的差异

- 系统版本为 **7.21.3**，相对 7.20.6 为较新版本，包含上述官方修复与改进。
- 脚本与流程与 v7.20.6 一致，仅镜像文件名与 Release 标签不同。

## 相关链接

- 本版本脚本：[v7.21.3install.sh](v7.21.3install.sh)
- 仓库 Releases：[qing-ros-images Releases](https://github.com/qing48674431-cmd/qing-ros-images/releases)
- 仓库总览：[README.md](README.md)
- v7.20.6 说明：[v7.20.6.md](v7.20.6.md)
- 官方版本与更新说明：[elseif/MikroTikPatch Releases](https://github.com/elseif/MikroTikPatch/releases)
